================================================================================
COMO FAZER A SINCRONIZAÃ‡ÃƒO AUTOMÃTICA FUNCIONAR
================================================================================

PROBLEMA: Sistema atualiza, mas Google Sheets nÃ£o atualiza automaticamente.

SOLUÃ‡ÃƒO: Criar Google Apps Script que recebe os dados e atualiza a planilha.

================================================================================
PASSO 1: CRIAR GOOGLE APPS SCRIPT (5 minutos)
================================================================================

1. Abra sua planilha do Google Sheets:
   https://docs.google.com/spreadsheets/d/1iiU5nCUfVIBaBw-80XgR9cs6irlk748kt3S4UMrc5yE/edit

2. Clique em: ExtensÃµes > Apps Script

3. Apague tudo que estiver lÃ¡ e cole este cÃ³digo:

function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const ss = SpreadsheetApp.openById(data.sheet_id);
    let sheet = ss.getSheetByName(data.sheet_name || 'Batizantes');
    if (!sheet) sheet = ss.insertSheet(data.sheet_name || 'Batizantes');
    
    if (!data.values || data.values.length === 0) {
      return ContentService.createTextOutput(JSON.stringify({
        success: false, error: 'Nenhum dado recebido'
      })).setMimeType(ContentService.MimeType.JSON);
    }
    
    sheet.clear();
    sheet.getRange(1, 1, data.values.length, data.values[0].length).setValues(data.values);
    
    if (data.values.length > 0) {
      const headerRange = sheet.getRange(1, 1, 1, data.values[0].length);
      headerRange.setFontWeight('bold');
      headerRange.setBackground('#4285f4');
      headerRange.setFontColor('#ffffff');
    }
    
    return ContentService.createTextOutput(JSON.stringify({
      success: true, message: 'Planilha atualizada'
    })).setMimeType(ContentService.MimeType.JSON);
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({
      success: false, error: error.toString()
    })).setMimeType(ContentService.MimeType.JSON);
  }
}

4. Salve (Ctrl+S)

5. Clique em "Implementar" (botÃ£o azul no canto superior direito)

6. Selecione "Nova implementaÃ§Ã£o"

7. Configure:
   - Tipo: Aplicativo Web
   - Executar como: Eu mesmo
   - Quem tem acesso: Qualquer pessoa

8. Clique em "Implementar"

9. Autorize quando solicitado (escolha sua conta, clique em AvanÃ§ado > Ir para...)

10. COPIE A URL que aparece (algo como: https://script.google.com/macros/s/ABC.../exec)
    âš ï¸ VOCÃŠ VAI PRECISAR DESSA URL NO PRÃ“XIMO PASSO!

================================================================================
PASSO 2: CONFIGURAR NO SUPABASE (2 minutos)
================================================================================

1. Abra: https://app.supabase.com

2. VÃ¡ em: Settings (Ã­cone de engrenagem) > Edge Functions > Secrets

3. Clique em "Add new secret"

4. Preencha:
   Name: GOOGLE_SHEETS_WEBHOOK_URL
   Value: Cole a URL que vocÃª copiou no Passo 1, item 10

5. Clique em "Save"

================================================================================
PASSO 3: TESTAR
================================================================================

1. Cadastre um novo batizante OU execute este SQL no Supabase:

INSERT INTO public.batismo_registrations (
  nome_completo, 
  lider_id, 
  tamanho_camiseta
) VALUES (
  'Teste AutomÃ¡tico',
  (SELECT id FROM profiles WHERE role = 'lider' LIMIT 1),
  'G'
);

2. Aguarde 2-3 segundos

3. Abra o Google Sheets e veja se atualizou! ðŸŽ‰

================================================================================
PRONTO! Agora estÃ¡ tudo automÃ¡tico!
================================================================================

Quando alguÃ©m cadastrar um batizante:
1. Sistema salva no banco âœ…
2. Webhook detecta âœ…
3. Edge Function Ã© chamada âœ…
4. Dados sÃ£o enviados para Google Apps Script âœ…
5. Google Sheets Ã© atualizado automaticamente âœ…


